ResourceManager HA 方案

Yarn 提交任务执行流程

Yarn 中用到的 RPC 协议

Hadoop RPC 架构



资源隔离



#### 如何支持多资源调度器，思路？

1. 在一个物理集群上虚拟多个 Hadoop 集群

   这些集群各自拥有全套独立的 Hadoop 服务，典型代表是 HOD 调度器（仅在 Hadoop 1.0 中提供，Haddop 2.0 开始不再包含）。

2. 扩展 Hadoop 调度器，支持多个队列多个用户

   可以允许管理员按照需求对用户或者应用程序进行分组，并为不同的分组分配不同的资源量，同时通过添加各种约束来防止单个用户或应用程序独占资源。

Hadoop 2.0 之后 Yarn 采用的就是**多队列方式**。

#### 资源保证机制？

1. 增量资源分配

   当应用程序申请的资源暂时无法保证时，**优先为其预留**一个节点上的资源直到累积释放的空闲资源满足需求为止。

2. 一次性资源分配

   当应用程序申请的资源暂时无法保证时，**暂时放弃**当前资源直到出现一个节点的剩余资源能够一次性满足需求为止。

前者会造成资源浪费，后者会产生饿死现象即可能一直等下去，**Yarn 采用的是增量资源分配机制**。

#### 什么时候会发生资源抢占？

每个队列会设置最小资源量和最大资源量，**为了提高资源利用率**资源调度器会将负载比较轻的队列 A 的资源暂时分配给负载中的队列 B，这个时候 A 的**最小资源量可能没有满足**，如果此时 A 突然收到新提交的应用需求申请资源时，可能就需要从 B 中抢回属于 A 的那部分资源。

#### 资源调度器的分类？

资源调度器关注的是如何将节点上空闲的资源分配给应用程序。

